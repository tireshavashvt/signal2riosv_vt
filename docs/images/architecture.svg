<?xml version="1.0" encoding="UTF-8"?>
<svg width="800" height="600" viewBox="0 0 800 600" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="2" dy="2" stdDeviation="3" flood-opacity="0.15"/>
    </filter>
    <linearGradient id="primaryGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#2e7d6b"/>
      <stop offset="100%" style="stop-color:#1e5c4d"/>
    </linearGradient>
    <linearGradient id="secondaryGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#f59e0b"/>
      <stop offset="100%" style="stop-color:#d97706"/>
    </linearGradient>
    <linearGradient id="tertiaryGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#3b82f6"/>
      <stop offset="100%" style="stop-color:#2563eb"/>
    </linearGradient>
  </defs>

  <!-- Background -->
  <rect width="800" height="600" fill="#f8fafb"/>

  <!-- Title -->
  <text x="400" y="35" text-anchor="middle" font-family="Inter, sans-serif" font-size="20" font-weight="600" fill="#1a1a2e">
    Архитектура на системата
  </text>

  <!-- User Layer -->
  <g transform="translate(350, 60)">
    <rect x="0" y="0" width="100" height="60" rx="8" fill="url(#primaryGrad)" filter="url(#shadow)"/>
    <text x="50" y="25" text-anchor="middle" font-family="Inter, sans-serif" font-size="24" fill="white">
      &#128100;
    </text>
    <text x="50" y="48" text-anchor="middle" font-family="Inter, sans-serif" font-size="11" font-weight="500" fill="white">
      Потребител
    </text>
  </g>

  <!-- Arrow 1 -->
  <path d="M400 125 L400 155" stroke="#94a3b8" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#94a3b8"/>
    </marker>
  </defs>

  <!-- PWA Frontend -->
  <g transform="translate(300, 160)">
    <rect x="0" y="0" width="200" height="70" rx="10" fill="white" stroke="#2e7d6b" stroke-width="2" filter="url(#shadow)"/>
    <rect x="0" y="0" width="200" height="25" rx="10" fill="#e8f5f1"/>
    <rect x="0" y="15" width="200" height="10" fill="#e8f5f1"/>
    <text x="100" y="17" text-anchor="middle" font-family="Inter, sans-serif" font-size="10" font-weight="600" fill="#2e7d6b">
      FRONTEND
    </text>
    <text x="100" y="45" text-anchor="middle" font-family="Inter, sans-serif" font-size="13" font-weight="600" fill="#1a1a2e">
      PWA (index.html)
    </text>
    <text x="100" y="60" text-anchor="middle" font-family="Inter, sans-serif" font-size="10" fill="#6b7280">
      Vanilla JS + docx.js
    </text>
  </g>

  <!-- Arrow 2 -->
  <path d="M400 235 L400 265" stroke="#94a3b8" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>

  <!-- Cloudflare Section -->
  <g transform="translate(50, 270)">
    <!-- Cloudflare Container -->
    <rect x="0" y="0" width="700" height="180" rx="12" fill="white" stroke="#e5e7eb" stroke-width="1" filter="url(#shadow)"/>
    <rect x="0" y="0" width="700" height="30" rx="12" fill="#fff7ed"/>
    <rect x="0" y="18" width="700" height="12" fill="#fff7ed"/>
    <text x="350" y="20" text-anchor="middle" font-family="Inter, sans-serif" font-size="11" font-weight="600" fill="#f59e0b">
      CLOUDFLARE INFRASTRUCTURE
    </text>

    <!-- Turnstile -->
    <g transform="translate(30, 50)">
      <rect x="0" y="0" width="140" height="80" rx="8" fill="white" stroke="#f59e0b" stroke-width="2"/>
      <text x="70" y="30" text-anchor="middle" font-family="Inter, sans-serif" font-size="20">
        &#128737;
      </text>
      <text x="70" y="50" text-anchor="middle" font-family="Inter, sans-serif" font-size="11" font-weight="600" fill="#1a1a2e">
        Turnstile
      </text>
      <text x="70" y="65" text-anchor="middle" font-family="Inter, sans-serif" font-size="9" fill="#6b7280">
        Anti-bot CAPTCHA
      </text>
    </g>

    <!-- Workers -->
    <g transform="translate(200, 50)">
      <rect x="0" y="0" width="180" height="80" rx="8" fill="white" stroke="#3b82f6" stroke-width="2"/>
      <text x="90" y="30" text-anchor="middle" font-family="Inter, sans-serif" font-size="20">
        &#9889;
      </text>
      <text x="90" y="50" text-anchor="middle" font-family="Inter, sans-serif" font-size="11" font-weight="600" fill="#1a1a2e">
        Workers (Functions)
      </text>
      <text x="90" y="65" text-anchor="middle" font-family="Inter, sans-serif" font-size="9" fill="#6b7280">
        /api/submit, /api/confirm
      </text>
    </g>

    <!-- KV -->
    <g transform="translate(410, 50)">
      <rect x="0" y="0" width="130" height="80" rx="8" fill="white" stroke="#2e7d6b" stroke-width="2"/>
      <text x="65" y="30" text-anchor="middle" font-family="Inter, sans-serif" font-size="20">
        &#128451;
      </text>
      <text x="65" y="50" text-anchor="middle" font-family="Inter, sans-serif" font-size="11" font-weight="600" fill="#1a1a2e">
        KV Store
      </text>
      <text x="65" y="65" text-anchor="middle" font-family="Inter, sans-serif" font-size="9" fill="#6b7280">
        Pending signals
      </text>
    </g>

    <!-- Pages -->
    <g transform="translate(570, 50)">
      <rect x="0" y="0" width="100" height="80" rx="8" fill="white" stroke="#2e7d6b" stroke-width="2"/>
      <text x="50" y="30" text-anchor="middle" font-family="Inter, sans-serif" font-size="20">
        &#127760;
      </text>
      <text x="50" y="50" text-anchor="middle" font-family="Inter, sans-serif" font-size="11" font-weight="600" fill="#1a1a2e">
        Pages
      </text>
      <text x="50" y="65" text-anchor="middle" font-family="Inter, sans-serif" font-size="9" fill="#6b7280">
        Static hosting
      </text>
    </g>

    <!-- Internal arrows -->
    <path d="M170 90 L200 90" stroke="#94a3b8" stroke-width="1.5" fill="none" marker-end="url(#arrowhead)"/>
    <path d="M380 90 L410 90" stroke="#94a3b8" stroke-width="1.5" fill="none" marker-end="url(#arrowhead)"/>
  </g>

  <!-- Arrow 3 -->
  <path d="M400 455 L400 485" stroke="#94a3b8" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <text x="410" y="475" font-family="Inter, sans-serif" font-size="9" fill="#6b7280">Email API</text>

  <!-- Email Section -->
  <g transform="translate(150, 490)">
    <!-- Postal Server -->
    <rect x="0" y="0" width="200" height="70" rx="10" fill="white" stroke="#f59e0b" stroke-width="2" filter="url(#shadow)"/>
    <text x="100" y="28" text-anchor="middle" font-family="Inter, sans-serif" font-size="18">
      &#128231;
    </text>
    <text x="100" y="48" text-anchor="middle" font-family="Inter, sans-serif" font-size="12" font-weight="600" fill="#1a1a2e">
      Postal Server
    </text>
    <text x="100" y="62" text-anchor="middle" font-family="Inter, sans-serif" font-size="9" fill="#6b7280">
      SMTP / HTTPS API
    </text>
  </g>

  <!-- Arrow 4 -->
  <path d="M355 525 L445 525" stroke="#94a3b8" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>

  <!-- RIOSV -->
  <g transform="translate(450, 490)">
    <rect x="0" y="0" width="200" height="70" rx="10" fill="url(#primaryGrad)" filter="url(#shadow)"/>
    <text x="100" y="28" text-anchor="middle" font-family="Inter, sans-serif" font-size="18">
      &#127970;
    </text>
    <text x="100" y="48" text-anchor="middle" font-family="Inter, sans-serif" font-size="12" font-weight="600" fill="white">
      РИОСВ – В. Търново
    </text>
    <text x="100" y="62" text-anchor="middle" font-family="Inter, sans-serif" font-size="9" fill="rgba(255,255,255,0.8)">
      riosvt-vt@riosvt-vt.org
    </text>
  </g>

  <!-- Legend -->
  <g transform="translate(30, 550)">
    <rect x="0" y="0" width="15" height="15" rx="3" fill="#2e7d6b"/>
    <text x="22" y="12" font-family="Inter, sans-serif" font-size="10" fill="#6b7280">Primary</text>

    <rect x="80" y="0" width="15" height="15" rx="3" fill="#f59e0b"/>
    <text x="102" y="12" font-family="Inter, sans-serif" font-size="10" fill="#6b7280">External</text>

    <rect x="160" y="0" width="15" height="15" rx="3" fill="#3b82f6"/>
    <text x="182" y="12" font-family="Inter, sans-serif" font-size="10" fill="#6b7280">Compute</text>
  </g>
</svg>
